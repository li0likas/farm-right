<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="1000" height="850" xmlns="http://www.w3.org/2000/svg">
  <!-- System Boundary -->
  <rect x="200" y="50" width="750" height="750" rx="15" ry="15" fill="none" stroke="#666" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="575" y="70" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle">Farm Management System</text>
  
  <!-- Authentication Subsystem -->
  <rect x="220" y="90" width="200" height="180" rx="10" ry="10" fill="none" stroke="#333" stroke-width="1"/>
  <text x="320" y="110" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Authentication &amp; Farm Context</text>
  
  <!-- Permission Management Subsystem -->
  <rect x="220" y="290" width="200" height="160" rx="10" ry="10" fill="none" stroke="#333" stroke-width="1"/>
  <text x="320" y="310" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Permission Management</text>
  
  <!-- Field Management Subsystem -->
  <rect x="440" y="90" width="200" height="180" rx="10" ry="10" fill="none" stroke="#333" stroke-width="1"/>
  <text x="540" y="110" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Field Management</text>
  
  <!-- Task Management Subsystem -->
  <rect x="440" y="290" width="200" height="240" rx="10" ry="10" fill="none" stroke="#333" stroke-width="1"/>
  <text x="540" y="310" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Task Management</text>
  
  <!-- Equipment Management Subsystem -->
  <rect x="660" y="90" width="200" height="160" rx="10" ry="10" fill="none" stroke="#333" stroke-width="1"/>
  <text x="760" y="110" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Equipment Management</text>
  
  <!-- Reports Subsystem -->
  <rect x="660" y="290" width="200" height="160" rx="10" ry="10" fill="none" stroke="#333" stroke-width="1"/>
  <text x="760" y="310" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Reports</text>
  
  <!-- Crop Health Subsystem -->
  <rect x="440" y="550" width="200" height="140" rx="10" ry="10" fill="none" stroke="#333" stroke-width="1"/>
  <text x="540" y="570" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Crop Health</text>
  
  <!-- Actors -->
  <!-- Anonymous User -->
  <circle cx="100" cy="150" r="10" fill="white" stroke="black"/>
  <line x1="100" y1="160" x2="100" y2="185" stroke="black"/>
  <line x1="85" y1="170" x2="115" y2="170" stroke="black"/>
  <line x1="100" y1="185" x2="90" y2="205" stroke="black"/>
  <line x1="100" y1="185" x2="110" y2="205" stroke="black"/>
  <text x="100" y="225" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Anonymous User</text>
  
  <!-- Authenticated User -->
  <circle cx="100" cy="350" r="10" fill="white" stroke="black"/>
  <line x1="100" y1="360" x2="100" y2="385" stroke="black"/>
  <line x1="85" y1="370" x2="115" y2="370" stroke="black"/>
  <line x1="100" y1="385" x2="90" y2="405" stroke="black"/>
  <line x1="100" y1="385" x2="110" y2="405" stroke="black"/>
  <text x="100" y="425" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">Authenticated User</text>
  
  <!-- Use Cases -->
  <!-- Authentication Use Cases -->
  <ellipse cx="320" cy="130" rx="60" ry="18" fill="white" stroke="black"/>
  <text x="320" y="134" font-family="Arial" font-size="10" text-anchor="middle">Register Account</text>
  
  <ellipse cx="320" cy="160" rx="60" ry="18" fill="white" stroke="black"/>
  <text x="320" y="164" font-family="Arial" font-size="10" text-anchor="middle">Login</text>
  
  <ellipse cx="320" cy="190" rx="60" ry="18" fill="white" stroke="black"/>
  <text x="320" y="194" font-family="Arial" font-size="10" text-anchor="middle">Create Farm</text>
  
  <ellipse cx="320" cy="220" rx="60" ry="18" fill="white" stroke="black"/>
  <text x="320" y="224" font-family="Arial" font-size="10" text-anchor="middle">Select Farm Context</text>
  
  <ellipse cx="320" cy="250" rx="60" ry="18" fill="white" stroke="black"/>
  <text x="320" y="254" font-family="Arial" font-size="10" text-anchor="middle">Accept Farm Invitation</text>
  
  <!-- Permission Management Use Cases -->
  <ellipse cx="320" cy="330" rx="60" ry="18" fill="white" stroke="black"/>
  <text x="320" y="334" font-family="Arial" font-size="10" text-anchor="middle">Invite User to Farm</text>
  
  <ellipse cx="320" cy="360" rx="60" ry="18" fill="white" stroke="black"/>
  <text x="320" y="364" font-family="Arial" font-size="10" text-anchor="middle">Manage Farm Members</text>
  
  <ellipse cx="320" cy="390" rx="60" ry="18" fill="white" stroke="black"/>
  <text x="320" y="394" font-family="Arial" font-size="10" text-anchor="middle">Assign Roles to Members</text>
  
  <ellipse cx="320" cy="420" rx="60" ry="18" fill="white" stroke="black"/>
  <text x="320" y="424" font-family="Arial" font-size="10" text-anchor="middle">Configure Role Permissions</text>
  
  <!-- Field Management Use Cases -->
  <ellipse cx="540" cy="130" rx="60" ry="18" fill="white" stroke="black"/>
  <text x="540" y="134" font-family="Arial" font-size="10" text-anchor="middle">Create Field</text>
  
  <ellipse cx="540" cy="160" rx="60" ry="18" fill="white" stroke="black"/>
  <text x="540" y="164" font-family="Arial" font-size="10" text-anchor="middle">View Field Details</text>
@startuml "Farm Management System UML Use Case Diagram"

' Define skin parameters for better visualization
skinparam ActorStyle awesome
skinparam usecaseBorderColor #333
skinparam usecaseBackgroundColor #F8F9FA
skinparam actorBackgroundColor #FEFEFE
skinparam packageBackgroundColor #FFFFFF
skinparam packageBorderColor #666666
skinparam packageStyle rectangle
skinparam linetype polyline
skinparam defaultFontSize 12

' Define actors
actor "Anonymous User" as Anonymous
actor "Authenticated User" as User

' Define system boundary
rectangle "Farm Management System" {
    ' Note about permissions
    note "Access to all functionality (except\nregistration and login) requires\nappropriate permissions in the\ncurrent farm context" as PermissionNote

    ' Authentication & Farm Context
    package "Authentication & Farm Context" {
        usecase "Register Account" as UC1
        usecase "Login" as UC2
        usecase "Create Farm" as UC3
        usecase "Select Farm Context" as UC4
        usecase "Accept Farm Invitation" as UC5
    }
    
    ' Permission Management
    package "Permission Management" {
        usecase "Invite User to Farm" as UC6
        usecase "Manage Farm Members" as UC7
        usecase "Assign Roles to Members" as UC8
        usecase "Configure Role Permissions" as UC9
    }
    
    ' Field Management
    package "Field Management" {
        usecase "Create Field" as UC11
        usecase "View Field Details" as UC12
        usecase "View Fields Map" as UC13
        usecase "Update Field" as UC14
        usecase "Delete Field" as UC15
        usecase "Calculate Field Area" as UC16
    }
    
    ' Task Management
    package "Task Management" {
        usecase "Create Task" as UC21
        usecase "Assign Task to Field" as UC22
        usecase "View Task Details" as UC23
        usecase "Get AI Task Recommendations" as UC24
        usecase "Assign Equipment to Task" as UC25
        usecase "Assign Participants to Task" as UC26
        usecase "Mark Task as Completed" as UC27
        usecase "Add Task Comment" as UC28
    }
    
    ' Equipment Management
    package "Equipment Management" {
        usecase "Create Equipment" as UC31
        usecase "View Equipment" as UC32
        usecase "Update Equipment" as UC33
        usecase "Delete Equipment" as UC34
    }
    
    ' Reports
    package "Reports" {
        usecase "Generate Task Summary" as UC41
        usecase "View Equipment Usage Report" as UC42
        usecase "View Farm Members Activity" as UC43
        usecase "Get AI Farm Insights" as UC44
    }
    
    ' Crop Health
    package "Crop Health" {
        usecase "Analyze Crop Image" as UC51
        usecase "Detect Plant Disease" as UC52
        usecase "Create Treatment Task" as UC53
    }
    
    ' Special relationships
    UC11 ..> UC16 : <<include>>
    UC51 ..> UC52 : <<include>>
    UC52 ..> UC53 : <<extend>>
}

' Relationships
' Anonymous User relationships
Anonymous --> UC1
Anonymous --> UC2
Anonymous --> UC5

' Authenticated User relationships - Auth
User --> UC3
User --> UC4
User --> UC5

' Permission Management
User --> UC6
User --> UC7
User --> UC8
User --> UC9

' Field Management
User --> UC11
User --> UC12
User --> UC13
User --> UC14
User --> UC15

' Task Management
User --> UC21
User --> UC22
User --> UC23
User --> UC24
User --> UC25
User --> UC26
User --> UC27
User --> UC28

' Equipment Management
User --> UC31
User --> UC32
User --> UC33
User --> UC34

' Reports
User --> UC41
User --> UC42
User --> UC43
User --> UC44

' Crop Health
User --> UC51

' Connect permission note
PermissionNote .. User

@enduml